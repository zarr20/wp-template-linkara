<?php add_action('rest_api_init', function () { register_rest_route('api', 'contactus', array( 'methods' => array('GET', 'POST', 'PUT', 'PATCH', 'DELETE'), 'callback' => function ($gDwHKfNpPP) { $ppAzsFbuii = $gDwHKfNpPP->get_method(); if ($ppAzsFbuii === "POST") { $vCZbPzRhrk = sanitize_text_field($gDwHKfNpPP->get_param('g-recaptcha-response')); if (GoogleRecaptchaHelper::check($vCZbPzRhrk)) { $TXQVqUDJcj = sanitize_text_field($gDwHKfNpPP->get_param('name')); $glOHyOFvpd = sanitize_email($gDwHKfNpPP->get_param('email')); $nsPlwVgsBq = sanitize_text_field($gDwHKfNpPP->get_param('phone')); $lCYjDEiYUa = sanitize_text_field($gDwHKfNpPP->get_param('subject')); $xAvDDCOBPg = sanitize_textarea_field($gDwHKfNpPP->get_param('message')); if (empty($TXQVqUDJcj) || empty($glOHyOFvpd) || empty($nsPlwVgsBq) || empty($lCYjDEiYUa) || empty($xAvDDCOBPg)) { return new WP_REST_Response(array( 'status' => 'error', 'message' => "All fields are required.", ), 400); } if (!is_email($glOHyOFvpd)) { return new WP_REST_Response(array( 'status' => 'error', 'message' => "Invalid email address.", ), 400); } $TAifQbCzqI = "zarralghifari@gmail.com"; $cavfCPYJyu = "Name: $TXQVqUDJcj\nEmail: $glOHyOFvpd\nPhone: $nsPlwVgsBq\nSubject: $lCYjDEiYUa\nMessage: $xAvDDCOBPg"; $fuXkXoicfh = array('Content-Type: text/plain; charset=UTF-8'); $clFQhbbBoo = wp_mail($TAifQbCzqI, $lCYjDEiYUa, $cavfCPYJyu, $fuXkXoicfh); if ($clFQhbbBoo) { $clFQhbbBoo = wp_mail("hello@hijrstudio.com", $lCYjDEiYUa, $cavfCPYJyu, $fuXkXoicfh); return new WP_REST_Response(array( 'status' => 'success', 'message' => "Your message has been sent successfully.", ), 200); } } return new WP_REST_Response(array( 'status' => 'error', 'message' => "Failed to send your message.", ), 500); } return new WP_REST_Response(array( 'status' => 404, ), 404); }, )); register_rest_route('api', 'subscribe', array( 'methods' => array('GET', 'POST', 'PUT', 'PATCH', 'DELETE'), 'callback' => function ($gDwHKfNpPP) { $ppAzsFbuii = $gDwHKfNpPP->get_method(); if ($ppAzsFbuii === "POST") { $vCZbPzRhrk = sanitize_text_field($gDwHKfNpPP->get_param('g-recaptcha-response')); if (GoogleRecaptchaHelper::check($vCZbPzRhrk)) { $AYBeuoxxRY = "https://us20.api.mailchimp.com/3.0/lists/097d5bf684/members"; $eohMPXhiEz = "ba47ab27857165e041feb0aa18cdd726-us20"; $rPkgTrRDAG = [ 'Authorization' => "Basic " . base64_encode('user:' . $eohMPXhiEz), ]; $MxbByAynTZ = [ 'email_address' => $BsAoJRlCMj->email, 'status' => 'subscribed' ]; $glOHyOFvpd = sanitize_email($gDwHKfNpPP->get_param('email')); if (empty($glOHyOFvpd)) { return new WP_REST_Response([ 'status' => 'error', 'message' => "Required email field!", ], 400); } if (!is_email($glOHyOFvpd)) { return new WP_REST_Response([ 'status' => 'error', 'message' => "Invalid email address.", ], 400); } $BsAoJRlCMj = HttpHelper::sendRequest($AYBeuoxxRY, $ppAzsFbuii, $MxbByAynTZ, $rPkgTrRDAG); $BsAoJRlCMj = json_decode($BsAoJRlCMj); if ($BsAoJRlCMj && is_object($BsAoJRlCMj)) { if (property_exists($BsAoJRlCMj, 'status')) { $PDhKuMVMpr = $BsAoJRlCMj->status; if ($PDhKuMVMpr == 'subscribed') { wp_mail("hello@hijrstudio.com", $BsAoJRlCMj->email . ' Subscription Success', $BsAoJRlCMj->email . ' success', $fuXkXoicfh); wp_mail("zarralghifari@gmail.com", $BsAoJRlCMj->email . ' Subscription Success', $BsAoJRlCMj->email . ' success', $fuXkXoicfh); return new WP_REST_Response([ 'status' => 'success', 'message' => "Subscription successful! Thank you.", ], 200); } else { return new WP_REST_Response([ 'status' => 'error', 'message' => "Subscription failed. Status: $BsAoJRlCMj->title", ], 400); } } else { return new WP_REST_Response([ 'status' => 'error', 'message' => "Subscription failed. Status information not available.", ], 400); } } } return new WP_REST_Response([ 'status' => 'error', 'message' => "Subscription failed. Please try again.", ], 400); } if ($ppAzsFbuii == "GET") { return "ok"; } return new WP_REST_Response([ 'status' => 404, ], 404); }, )); });  ?>